(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{45:function(e,t,n){},62:function(e,t,n){e.exports=n(93)},93:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(17),l=n.n(c),u=n(7),o=n(11),s=n(98),i=n(99),d=n(95),m=n(97),p=function(e){var t=e.handleLogin,n=e.username,a=e.password;return r.a.createElement("div",null,r.a.createElement("h1",null,"Login"),r.a.createElement(m.a,{onSubmit:t},r.a.createElement(m.a.Group,null,r.a.createElement(m.a.Label,null,"Username:"),r.a.createElement(m.a.Control,Object.assign({},n,{reset:"",id:"username"})),r.a.createElement(m.a.Label,null,"Password:"),r.a.createElement(m.a.Control,Object.assign({},a,{reset:"",id:"password"})),r.a.createElement(d.a,{variant:"success",type:"submit",id:"login-button"},"login"))))},f=function(e){var t=e.handleAddBlog,n=e.title,a=e.author,c=e.url;return r.a.createElement(m.a,{onSubmit:t},r.a.createElement(m.a.Group,null,r.a.createElement(m.a.Label,null,"Title:"),r.a.createElement(m.a.Control,Object.assign({},n,{reset:"",id:"title"})),r.a.createElement(m.a.Label,null,"Author:"),r.a.createElement(m.a.Control,Object.assign({},a,{reset:"",id:"author"})),r.a.createElement(m.a.Label,null,"Url:"),r.a.createElement(m.a.Control,Object.assign({},c,{reset:"",id:"url"})),r.a.createElement(d.a,{variant:"success",type:"submit",id:"add-button"},"Add")))},b=function(e){var t=e.create,n=e.fullname,a=e.username,c=e.password;return r.a.createElement("div",null,r.a.createElement("h1",null,"Sign up"),r.a.createElement(m.a,{onSubmit:t},r.a.createElement(m.a.Group,null,r.a.createElement(m.a.Label,null,"Name:"),r.a.createElement(m.a.Control,Object.assign({},n,{reset:"",id:"name"})),r.a.createElement(m.a.Label,null,"Username:"),r.a.createElement(m.a.Control,Object.assign({},a,{reset:"",id:"username"})),r.a.createElement(m.a.Label,null,"Password:"),r.a.createElement(m.a.Control,Object.assign({},c,{reset:"",id:"password"})),r.a.createElement(d.a,{variant:"success",type:"submit",id:"create-button"},"sign up"))))},E=n(8),v=(n(45),function(){var e=Object(E.c)((function(e){return e.notification})),t=function(){return""===e.notification};return"error"===e.message?t()?null:r.a.createElement("div",{className:"error"},e.notification):"message"===e.message?t()?null:r.a.createElement("div",{className:"added"},e.notification):null}),g=function(){var e=Object(E.c)((function(e){return e.blogs}));return console.log(e.length),0===e.length?null:r.a.createElement("div",{id:"blogs"},r.a.createElement("h3",null,"Blogs"),e.map((function(e){return r.a.createElement("div",{className:"list",id:"box",key:e.id},r.a.createElement(o.b,{to:"/blogs/".concat(e.id)},e.title,", by ",e.author))})))},h=function(e,t,n){var a=1e3*t;return function(t){t({type:"SET_NOTIFICATION",data:e,message:n}),setTimeout((function(){t({type:"HIDE_NOTIFICATION",data:"",message:""})}),a)}},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION":return e={notification:t.data,message:t.message};case"HIDE_NOTIFICATION":return e=t.data;default:return e}},w=n(30),y=n(41),k=n(5),j=n.n(k),x=n(6),L=n(13),T=n.n(L),I="/api/blogs",N=null,A=function(){var e=Object(x.a)(j.a.mark((function e(t){var n,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:N}},e.next=3,T.a.post(I,t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(x.a)(j.a.mark((function e(t,n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.a.put("".concat(I,"/").concat(t),n);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),C=function(){var e=Object(x.a)(j.a.mark((function e(t,n){var a,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:N}},e.next=3,T.a.post("".concat(I,"/").concat(t,"/comments"),n,a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),G={getAll:function(){return T.a.get(I).then((function(e){return e.data}))},create:A,setToken:function(e){N="bearer ".concat(e)},update:_,deleteBlog:function(){var e=Object(x.a)(j.a.mark((function e(t){var n,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:N}},e.next=3,T.a.delete("".concat(I,"/").concat(t),n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getOne:function(e){return T.a.get("".concat(I,"/").concat(e)).then((function(e){return e.data}))},createComment:C},S={getAll:function(){return T.a.get("/api/users").then((function(e){return e.data}))},create:function(){var e=Object(x.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.a.post("/api/users",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getOne:function(e){return T.a.get("".concat("/api/users","/").concat(e)).then((function(e){return e.data}))}},B=function(){return function(){var e=Object(x.a)(j.a.mark((function e(t){var n,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.getAll();case 2:n=e.sent,a=n.sort((function(e,t){return t.blogs.length-e.blogs.length})),t({type:"INIT_USERS",data:a});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NEW_USER":return[].concat(Object(w.a)(e),[t.data]);case"INIT_USERS":return t.data;default:return e}},U=function(e){return function(){var t=Object(x.a)(j.a.mark((function t(n){var a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,G.getOne(e);case 3:a=t.sent,n({type:"WANTED_BLOG",data:a}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n(h(t.t0.response.data,5,"error"));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"WANTED_BLOG":case"COMMENTED_BLOG":return t.data;default:return e}},W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NEW_BLOG":return[].concat(Object(w.a)(e),[t.data]);case"INIT_BLOGS":case"UPDATE_BLOG":case"REMOVE_BLOG":return t.data;default:return e}},M=n(31),F=function(e){var t=Object(a.useState)(""),n=Object(M.a)(t,2),r=n[0],c=n[1];return{reset:function(){c("")},type:e,value:r,onChange:function(e){c(e.target.value)}}},V=function(e){var t=e.loggedIn,n=Object(u.g)(),c=Object(E.b)(),l=Object(u.h)().id,o=Object(E.c)((function(e){return e.blog})),s=Object(E.c)((function(e){return e.blogs})),i=F("");Object(a.useEffect)((function(){c(U(l))}),[c,l]);if(null===o)return null;var m=o.user.username===t.username;return r.a.createElement("div",{id:"blogTable"},r.a.createElement("div",null,r.a.createElement("h2",{"data-testid":"blog-data"},o.title,", made by ",o.author)),r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("a",{href:o.url},o.url),r.a.createElement("br",null),r.a.createElement("p",null,"likes: ",o.likes," "),r.a.createElement(d.a,{variant:"info",onClick:function(){c(function(e,t){var n=Object(y.a)(Object(y.a)({},t),{},{user:t.user.id,likes:t.likes+1});return function(){var a=Object(x.a)(j.a.mark((function a(r){var c,l;return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,G.update(t.id,n);case 2:c=a.sent,(l=e.map((function(e){return e.id!==c.id?e:c}))).sort((function(e,t){return t.likes-e.likes})),r(U(c.id)),r({type:"UPDATE_BLOG",data:l});case 7:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()}(s,o)),c(h('"'.concat(o.title,'" has been liked by you'),5,"message"))},id:"like-button","data-testid":"like"},"like"),r.a.createElement("p",null,"Added by ",o.user.name),m?r.a.createElement(d.a,{variant:"danger",onClick:function(){console.log(o),window.confirm("Are you sure, you want to delete ".concat(o.title," by ").concat(o.author))&&(c(function(e,t){return function(){var n=Object(x.a)(j.a.mark((function n(a){var r;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,G.deleteBlog(t.id);case 3:(r=e.filter((function(e){return e.id!==t.id}))).sort((function(e,t){return t.likes-e.likes})),a({type:"REMOVE_BLOG",data:r}),n.next=12;break;case 8:n.prev=8,n.t0=n.catch(0),console.log(n.t0),a(h("Blog is already removed or you are not allowed to remove this blog",5,"error"));case 12:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e){return n.apply(this,arguments)}}()}(s,o)),c(h('"'.concat(o.title,'" has been removed successfully'),5,"message")),n.push("/blogs"))},id:"remove-button"},"remove blog"):null,r.a.createElement("h4",null,"Comments"),r.a.createElement("br",null),r.a.createElement("div",null,r.a.createElement("input",Object.assign({},i,{reset:""})),r.a.createElement(d.a,{variant:"info",type:"submit",onClick:function(e){e.preventDefault(),c(function(e,t){var n={content:t.value};return function(){var a=Object(x.a)(j.a.mark((function a(r){var c;return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,G.createComment(e,n);case 3:c=a.sent,t.reset(),r({type:"COMMENTED_BLOG",data:c}),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),r(h(a.t0.response.data,5,"error"));case 11:case"end":return a.stop()}}),a,null,[[0,8]])})));return function(e){return a.apply(this,arguments)}}()}(l,i))}},"add comment")),0===o.comments.length?r.a.createElement("div",null,r.a.createElement("p",null,"no comments yet")):r.a.createElement("div",null,r.a.createElement("ul",null,o.comments.map((function(e){return r.a.createElement("li",{key:e.id},e.content)}))))))},J=n(96),P=function(){var e=Object(E.c)((function(e){return e.users}));return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Users"),r.a.createElement(J.a,{bordered:!0},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Name"),r.a.createElement("td",null,"Created blogs")),e.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,r.a.createElement(o.b,{to:"/users/".concat(e.id)},e.name)),r.a.createElement("td",null,e.blogs.length))})))))},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"WANTED_USER":return t.data;default:return e}},H=function(){var e=Object(u.h)().id,t=Object(E.b)(),n=Object(E.c)((function(e){return e.user}));return Object(a.useEffect)((function(){t(function(e){return function(){var t=Object(x.a)(j.a.mark((function t(n){var a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S.getOne(e);case 3:a=t.sent,n({type:"WANTED_USER",data:a}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n(h(t.t0.response.data,5,"error"));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}(e))}),[t,e]),n?r.a.createElement("div",{className:"container"},r.a.createElement("h3",null,n.name),r.a.createElement("h2",null,"Added blogs"),0===n.blogs.length?r.a.createElement("div",null,r.a.createElement("p",null,"no added blogs")):r.a.createElement("div",null,r.a.createElement("ul",null,n.blogs.map((function(e){return r.a.createElement("li",{key:e.id},e.title)}))))):null},q=r.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),c=Object(M.a)(n,2),l=c[0],u=c[1],o={display:l?"none":""},s={display:l?"":"none"},i=function(){u(!l)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:i}})),r.a.createElement("div",null,r.a.createElement("div",{style:o},r.a.createElement(d.a,{variant:"info",onClick:i},e.buttonLabel)),r.a.createElement("div",{style:s},e.children,r.a.createElement(d.a,{variant:"warning",onClick:i},"cancel")))}));q.displayName="Togglable";var Y=q,K={login:function(){var e=Object(x.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGGED_IN":case"FAILURE":case"LOGGED_OUT":return t.data;default:return e}},X=function(){var e=Object(u.g)(),t=F("text"),n=F("text"),c=F("url"),l=F("text"),m=F("password"),O=F("text"),w=F("text"),y=F("password"),k=Object(E.b)(),L=Object(E.c)((function(e){return e.loggedIn}));Object(a.useEffect)((function(){k(function(){var e=Object(x.a)(j.a.mark((function e(t){var n,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.getAll();case 2:n=e.sent,a=n.sort((function(e,t){return t.likes-e.likes})),t({type:"INIT_BLOGS",data:a});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[k]),Object(a.useEffect)((function(){k(function(){var e=JSON.parse(window.localStorage.getItem("loggedBlogAppUser")),t=e||null;return e&&G.setToken(e.token),function(){var e=Object(x.a)(j.a.mark((function e(n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n({type:"LOGGED_IN",data:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}())}),[k]),Object(a.useEffect)((function(){k(B())}),[k]);var T=function(e){e.preventDefault(),k(function(e,t){return function(){var n=Object(x.a)(j.a.mark((function n(a){var r,c,l;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.value,c=t.value,n.prev=2,n.next=5,K.login({username:r,password:c});case 5:l=n.sent,window.localStorage.setItem("loggedBlogAppUser",JSON.stringify(l)),e.reset(),t.reset(),G.setToken(l.token),a({type:"LOGGED_IN",data:l}),n.next=16;break;case 13:n.prev=13,n.t0=n.catch(2),a(h("Wrong username or password!",5,"error"));case 16:case"end":return n.stop()}}),n,null,[[2,13]])})));return function(e){return n.apply(this,arguments)}}()}(l,m))},I=function(t){t.preventDefault(),e.push("/login"),k(function(e,t,n){return function(){var a=Object(x.a)(j.a.mark((function a(r){var c,l;return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,c={name:e.value,username:t.value,password:n.value},a.next=4,S.create(c);case 4:l=a.sent,e.reset(),t.reset(),n.reset(),r({type:"NEW_USER",data:l}),a.next=14;break;case 11:a.prev=11,a.t0=a.catch(0),r(h(a.t0.response.data,5,"error"));case 14:case"end":return a.stop()}}),a,null,[[0,11]])})));return function(e){return a.apply(this,arguments)}}()}(O,w,y))},N=r.a.createRef(),A=function(e){e.preventDefault(),k(function(e,t,n){return function(){var a=Object(x.a)(j.a.mark((function a(r){var c,l;return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,c={author:e.value,title:t.value,url:n.value},a.next=4,G.create(c);case 4:l=a.sent,r(h('A new blog "'.concat(c.title,'" by "').concat(c.author,'" has been added'),5,"message")),r({type:"NEW_BLOG",data:l}),e.reset(),t.reset(),n.reset(),r(B()),a.next=18;break;case 13:a.prev=13,a.t0=a.catch(0),console.log(a.t0),"Validation error! Title and url required.  Title must be at least 1 character long",r(h("Validation error! Title and url required.  Title must be at least 1 character long",5,"error"));case 18:case"end":return a.stop()}}),a,null,[[0,13]])})));return function(e){return a.apply(this,arguments)}}()}(t,n,c)),N.current.toggleVisibility()};return r.a.createElement("div",{className:"container"},r.a.createElement(s.a,{collapseOnSelect:!0,expand:"lg",bg:"light",variant:"light"},r.a.createElement(s.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),r.a.createElement(s.a.Collapse,{id:"responsive-navbar-nav"},r.a.createElement(i.a,{className:"mr-auto"},r.a.createElement(i.a.Link,{href:"#",as:"span"},L?r.a.createElement(o.b,{to:"/blogs"},"blogs"):null),r.a.createElement(i.a.Link,{href:"#",as:"span"},L?r.a.createElement(o.b,{to:"/users"},"users"):null),r.a.createElement(i.a.Link,{href:"#",as:"span"},L?r.a.createElement("em",null,r.a.createElement("p",null,L.name," logged in")):r.a.createElement(o.b,{to:"/login"},"login")),r.a.createElement(i.a.Link,{href:"#",as:"span"},L?null:r.a.createElement(o.b,{to:"/signup"},"sign up")),r.a.createElement(i.a.Item,null,L?r.a.createElement(d.a,{type:"submit",onClick:function(t){t.preventDefault(),e.push("/login"),k(function(){var e=Object(x.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.localStorage.removeItem("loggedBlogAppUser"),t(h("You are succesfully logged out",5,"message")),t({type:"LOGGED_OUT",data:null});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},id:"logout-button"},"logout"):null)))),r.a.createElement(v,null),null===L?r.a.createElement("div",null,r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/login"},L?r.a.createElement(u.a,{to:"/users"}):r.a.createElement("div",null,r.a.createElement(Y,{buttonLabel:"sign in"},r.a.createElement(p,{handleLogin:T,username:l,password:m})))),r.a.createElement(u.b,{path:"/signup"},r.a.createElement("div",null,r.a.createElement(Y,{buttonLabel:"sign up"},r.a.createElement(b,{create:I,fullname:O,username:w,password:y})))))):r.a.createElement("div",null,r.a.createElement("h1",null,"Blog app"),r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/users/:id"},r.a.createElement(H,null)),r.a.createElement(u.b,{path:"/blogs/:id"},r.a.createElement(V,{loggedIn:L})),r.a.createElement(u.b,{path:"/users"},r.a.createElement(P,null)),r.a.createElement(u.b,{path:"/blogs"},r.a.createElement("div",null,r.a.createElement("h2",null,"Add new blog"),r.a.createElement(Y,{buttonLabel:"Add a new Blog",ref:N},r.a.createElement(f,{handleAddBlog:A,title:n,author:t,url:c})),r.a.createElement(g,null))))))},Z=n(20),$=n(60),ee=n(61),te=Object(Z.combineReducers)({notification:O,blogs:W,loggedIn:Q,users:D,user:z,blog:R}),ne=Object(Z.createStore)(te,Object(ee.composeWithDevTools)(Object(Z.applyMiddleware)($.a)));l.a.render(r.a.createElement(E.a,{store:ne},r.a.createElement(o.a,null,r.a.createElement(X,null))),document.getElementById("root"))}},[[62,1,2]]]);
//# sourceMappingURL=main.dededb19.chunk.js.map